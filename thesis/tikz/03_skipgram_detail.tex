\begin{figure}[h]
	\centering
	\begin{tikzpicture}[
		scale=0.335,
		every node/.style={scale=0.7},
		box/.style={rounded corners,dashed}
	]

		%\node[rotate=90] at (-12,0) {\highlight{center word}};
		\node[rotate=90] at (37,0) {\highlight{context words}};

		\draw[box,fill=lightgray!10] (-11,-12) rectangle (-5,14);
		\draw[box,fill=lightgray!10] (-3,-12) rectangle (7,14);
		\draw[box,fill=lightgray!10] (9,-12) rectangle (15,14);

		\node[align=center] at (-8,12) {$\vert \mathcal{V} \vert \times 1$ \\ $\bm{\widehat{v}}_{w_c}$};
		\node[align=center] at (-8,-8) {\highlight{One-hot} \\ \highlight{word vector} \\ \highlight{center word}};

		\node[align=center] at (2,12) {$d \times \vert \mathcal{V} \vert$ \\ $\bm{E}$};
		\node[align=center] at (2,-8) {\highlight{Word embedding matrix}};

		\node[align=center] at (12,12) {$d \times 1$ \\ $\bm{v}_{w_c}$};
		\node[align=center] at (12,-8) {\highlight{Word emb.} \\ \highlight{for center word}};

		\node[align=center] at (19,14) {$\vert \mathcal{V} \vert \times d$ \\ $\bm{U}$};
		\node[align=center] at (25,14) {$\vert \mathcal{V} \vert \times 1$ \\ $\bm{u}_{w_o}^{\intercal} \bm{v}_{w_c}$};
		\node[align=center] at (30,14) {$\vert \mathcal{V} \vert \times 1$ \\ soft-max};
		\node[align=center] at (35,14) {$\vert \mathcal{V} \vert \times 1$ \\ truth};

		\node at (-4,0) {\Large $\times$};
		\node at (8,0) {\Large $=$};

		\node at (-8,0) {$\begin{bmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 1 \\ 0 \\ 0 \\ 0 \end{bmatrix}$};
		\node at (2,0) {$
			\begin{bmatrix*}[r]
				\bullet 	& \hdots 	& 0.2 	& \hdots & \bullet \\[3.2mm]
				\bullet 	& \hdots 	& -1.4 	& \hdots & \bullet \\[3.2mm]
				\bullet 	& \hdots 	& 0.3 	& \hdots & \bullet \\[3.2mm]
				\bullet 	& \hdots 	& -0.1 	& \hdots & \bullet \\[3.2mm]
				\bullet 	& \hdots 	& 0.1 	& \hdots & \bullet \\[3.2mm]
				\bullet 	& \hdots 	& 0.5 	& \hdots & \bullet
			\end{bmatrix*}$};
		\node at (12,0) {$
			\begin{bmatrix*}[r]
				0.2 	\\[3.2mm]
				-1.4	\\[3.2mm]
				0.3 	\\[3.2mm]
				-0.1	\\[3.2mm]
				0.1 	\\[3.2mm]
				0.5
			\end{bmatrix*}$};

			\draw[thick] (16,-3.5) rectangle (22,3.7);
			\draw[thick] (16,-3.5) -- (22,5) -- (22,12.2) -- (16,3.7);
			\draw[thick] (16,3.7) -- (22,-5) -- (22,-12.2) -- (16,-3.5);

		\node at (25,8.75) {$
			\begin{bmatrix*}[r]
				0.2 		\\[3.2mm]
				0.3		\\[3.2mm]
				0.1 		\\[3.2mm]
				\vdots 	\\[3.2mm]
				0.7
			\end{bmatrix*}$};

		\node at (30,8.75) {$
			\begin{bmatrix*}[r]
				0.08 	\\[3.2mm]
				0.10	\\[3.2mm]
				0.05 	\\[3.2mm]
				\vdots 	\\[3.2mm]
				\textcolor{tud9c}{0.65}
			\end{bmatrix*}$};
			\node at (35,8.75) {$\begin{bmatrix} 0 \\[3.2mm] 0 \\[3.2mm] 0 \\[3.2mm] \vdots \\[3.2mm] \textcolor{tud9c}{1} \end{bmatrix}$};
			
		\node at (25,0.1) {$
			\begin{bmatrix*}[r]
				0.7 		\\[3.2mm]
				0.3		\\[3.2mm]
				0.1 		\\[3.2mm]
				\vdots 	\\[3.2mm]
				-0.1
			\end{bmatrix*}$};

		\node at (30,0.1) {$
			\begin{bmatrix*}[r]
				\textcolor{tud9c}{0.65} 	\\[3.2mm]
				0.10	\\[3.2mm]
				0.05 	\\[3.2mm]
				\vdots 	\\[3.2mm]
				0.03
			\end{bmatrix*}$};
			\node at (35,0.1) {$\begin{bmatrix} 0 \\[3.2mm] \textcolor{tud9c}{1} \\[3.2mm] 0 \\[3.2mm] \vdots \\[3.2mm] 0 \end{bmatrix}$};

		\node at (25,-8.75) {$
			\begin{bmatrix*}[r]
				0.5 		\\[3.2mm]
				0.7		\\[3.2mm]
				0.1		\\[3.2mm]
				\vdots 	\\[3.2mm]
				0.4
			\end{bmatrix*}$};

		\node at (30,-8.75) {$
			\begin{bmatrix*}[r]
				\textcolor{tud9c}{0.40} 	\\[3.2mm]
				0.15	\\[3.2mm]
				0.05 	\\[3.2mm]
				\vdots 	\\[3.2mm]
				0.30
			\end{bmatrix*}$};
			\node at (35,-8.75) {$\begin{bmatrix} 0 \\[3.2mm] 0 \\[3.2mm] 0 \\[3.2mm] \vdots \\[3.2mm] \textcolor{tud9c}{1} \end{bmatrix}$};

	\end{tikzpicture}
	\caption[Word2vec's skip-gram model architecture in detail]{The Skip-gram model in detail.
		Image taken and adapted from Manning: \url{https://www.youtube.com/watch?v=ERibwqs9p38}
		(Lecture recording from Stanford university; retrieved: September 04, 2019).}
	\label{fig:skipgram_detail}
\end{figure}