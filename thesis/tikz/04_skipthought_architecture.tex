\begin{figure}
	\centering
	\begin{tikzpicture}[
		scale=0.7,
		every node/.style={scale=0.8},
		arr/.style={-stealth,very thick},
		n/.style={circle,draw=black,fill=white,thick,minimum width=0.25cm},
		box/.style={fill=tud9c!15,rounded corners}
	]

		\draw[box] (-1,-3.25) rectangle (11.5,3.25); \node[rotate=90] at (-1.5,0) {\large\highlight{Encoder}};
		\draw[box] (12.5,0.5) rectangle (20.5,3.25); \node[rotate=90] at (21,2) {\large\highlight{Decoder 1}};
		\draw[box] (12.5,-3.25) rectangle (20.5,-0.5); \node[rotate=90] at (21,-2) {\large\highlight{Decoder 2}};
		\draw[box,fill=tud9c!35,dashed] (11,-1.32) rectangle (13,1.32);

		% middle sentence
		\node[n] (s1w1) at (0,0) {}; 		\node at (0,-0.75) {\strut\textbf{I}};
		\node[n] (s1w2) at (1.5,0) {}; 		\node at (1.5,-0.75) {\strut\textbf{could}}; 		\draw[arr] (s1w1) -- (s1w2);
		\node[n] (s1w3) at (3,0) {}; 		\node at (3,-0.75) {\strut\textbf{see}}; 			\draw[arr] (s1w2) -- (s1w3);
		\node[n] (s1w4) at (4.5,0) {}; 		\node at (4.5,-0.75) {\strut\textbf{the}}; 		\draw[arr] (s1w3) -- (s1w4);
		\node[n] (s1w5) at (6,0) {}; 		\node at (6,-0.75) {\strut\textbf{cat}}; 			\draw[arr] (s1w4) -- (s1w5);
		\node[n] (s1w6) at (7.5,0) {}; 		\node at (7.5,-0.75) {\strut\textbf{on}}; 		\draw[arr] (s1w5) -- (s1w6);
		\node[n] (s1w7) at (9,0) {}; 		\node at (9,-0.75) {\strut\textbf{the}}; 			\draw[arr] (s1w6) -- (s1w7);
		\node[n] (s1w8) at (10.5,0) {}; 	\node at (10.5,-0.75) {\strut\textbf{steps}}; 		\draw[arr] (s1w7) -- (s1w8);
		\node[n,fill=tud9c] (s1w9) at (12,0) {}; 	
										\node at (12,-0.75) {};						\draw[arr] (s1w8) -- (s1w9);

		% context sentence 1
		\node[n] (s2w1) at (13.5,2) {};	\node at (13.5,2.75) {\strut\textbf{I}};
		\node[n] (s2w2) at (15,2) {};		\node at (15,2.75) {\strut\textbf{got}}; 			\draw[arr] (s2w1) -- (s2w2);
		\node[n] (s2w3) at (16.5,2) {};	\node at (16.5,2.75) {\strut\textbf{back}}; 		\draw[arr] (s2w2) -- (s2w3);
		\node[n] (s2w4) at (18,2) {};		\node at (18,2.75) {\strut\textbf{home}}; 		\draw[arr] (s2w3) -- (s2w4);
		\node[n] (s2w5) at (19.5,2) {};	\node at (19.5,2.75) {\strut\textbf{<eos>}};	\draw[arr] (s2w4) -- (s2w5);
		
		% context sentence 2
		\node[n] (s3w1) at (13.5,-2) {};	\node at (13.5,-2.75) {\strut\textbf{This}};
		\node[n] (s3w2) at (15,-2) {};		\node at (15,-2.75) {\strut\textbf{was}}; 		\draw[arr] (s3w1) -- (s3w2);
		\node[n] (s3w3) at (16.5,-2) {};	\node at (16.5,-2.75) {\strut\textbf{very}}; 		\draw[arr] (s3w2) -- (s3w3);
		\node[n] (s3w4) at (18,-2) {};		\node at (18,-2.75) {\strut\textbf{strange}}; 	\draw[arr] (s3w3) -- (s3w4);
		\node[n] (s3w5) at (19.5,-2) {};	\node at (19.5,-2.75) {\strut\textbf{<eos>}}; 	\draw[arr] (s3w4) -- (s3w5);

		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (15,0) .. (s2w2);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (16,0) .. (s2w3);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (17,0) .. (s2w4);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (18,0) .. (s2w5);
		
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (15,0) .. (s3w2);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (16,0) .. (s3w3);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (17,0) .. (s3w4);
		\draw[-stealth,thick,gray,dotted] (s1w9) .. controls (18,0) .. (s3w5);

		\draw[arr] (s1w9) -- (s2w1);
		\draw[arr] (s1w9) -- (s3w1);

		\node (i) at (9,2) {\highlight{Encoded Sentence}}; \draw[thick,shorten <=2mm, shorten >=2mm,tud9c] (i) -- (s1w9);
		
	\end{tikzpicture}
	\caption[\textit{SkipThought} encoder architecture]
		{The \textit{Skip-Thought} model encodes the middle sentence `I could see the cat on the steps' and predicts the
		surrounding two sentences. The figure was taken and adapted from \citep{Kiros.2015}.}
	\label{fig:skipthought_architecture}
\end{figure}